#!/bin/sh

# Given a single image, set it
# Given a folder, set a random image within it

getrandom() {
  find "$1" -iregex ".*\.\(jpg\|gif\|png\|jpeg\|tiff\|bmp\)" | shuf -n 1
}

wall="$1"
if [ -d "$wall" ]; then
  wall="$(getrandom "$wall")"
fi

mimetype="$(file --mime-type -b "$wall")"
if [ "${mimetype%/*}" != "image" ]; then
  printf '%s\n' "unknown image format: $wall"
  exit 1
fi

#setroot --store --zoom "$wall"
feh --bg-fill "$wall" --no-fehbg
