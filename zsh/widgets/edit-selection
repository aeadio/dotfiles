# vim: ft=sh ts=2 sw=2 et:

emulate -L zsh

local x y selection
get-selection | read -r selection

if [[ -z $selection ]] return

() {
  ${=VISUAL:-$EDITOR} $1 || return
  replace-selection $(cat $1)
} =(<<<$selection)
